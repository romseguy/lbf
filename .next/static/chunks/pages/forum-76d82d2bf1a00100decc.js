(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[568],{46617:function(t,e,n){"use strict";n.d(e,{d:function(){return o}});var r=n(89867),i=n(67294),o=(0,r.I)({displayName:"EditIcon",path:i.createElement("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2"},i.createElement("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),i.createElement("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"}))})},19966:function(t,e,n){var r=n(29720).w_;t.exports.Z=function(t){return r({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"}}]})(t)}},79011:function(t,e,n){var r=n(29720).w_;t.exports.C=function(t){return r({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.82 458.1l-90.62-70.05c.19-1.38.8-2.66.8-4.06.05-7.55-2.61-15.27-8.61-21.71-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84c-40.33 8.38-74.66 31.07-97.59 62.57L45.47 3.37C38.49-2.05 28.43-.8 23.01 6.18L3.37 31.45C-2.05 38.42-.8 48.47 6.18 53.9l588.35 454.73c6.98 5.43 17.03 4.17 22.46-2.81l19.64-25.27c5.42-6.97 4.17-17.02-2.81-22.45zM157.23 251.54c-8.61 67.96-36.41 93.33-52.62 110.75-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h241.92L157.23 251.54zM320 512c35.32 0 63.97-28.65 63.97-64H256.03c0 35.35 28.65 64 63.97 64z"}}]})(t)}},32379:function(t,e,n){var r=n(29720).w_;t.exports.h=function(t){return r({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 256c52.805 0 96-43.201 96-96s-43.195-96-96-96-96 43.201-96 96 43.195 96 96 96zm0 48c-63.598 0-192 32.402-192 96v48h384v-48c0-63.598-128.402-96-192-96z"}}]})(t)}},48739:function(t,e,n){"use strict";n.d(e,{i:function(){return _}});var r=n(809),i=n.n(r),o=n(26265),u=n(92447),a=n(64121),c=n(40980),s=n(69822),l=n(27302),f=n(48017),p=n(83346),d=n(35528),v=(n(67294),n(97877)),g=n(17823),h=n(49759),m=n(18716),Z=n(1609),b=n(70917);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){(0,o.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var N=function(t){return void 0!==t.eventUrl},O=function(t){return void 0!==t.topicName},_=function(t){var e=t.event,n=t.org,r=t.query,y=t.mutation,_=t.setModalState,L=t.modalState,k=(0,c.useToast)({position:"top"}),S=(0,a.Z)(y,2),x=S[0],E=S[1],I=L.entity;if(!n&&!e||!I||!N(I)&&!O(I))return null;var C,j,P=n?n.orgName:e?e.eventName:"",z=n?n.orgSubscriptions:e?e.eventSubscriptions:[],M="",T="eventUrl",B="",D="l'\xe9v\xe9nement",A={orgIds:n?[n._id]:void 0},U=0;O(I)?(M=I._id,T="topicId",B=I.topicName,D="la discussion",A={org:n,event:e},z=z.filter((function(t){return void 0===t.phone})),I.topicNotified&&(U=(C=I.topicNotified).length)):N(I)&&(M=I.eventUrl,B=I.eventName,z=z.filter((function(t){return n&&t.orgs.find((function(t){return t.orgId===n._id&&t.type===m.NY.FOLLOWER}))})),I.eventNotified&&(U=(j=I.eventNotified).length));var V=function(){var t=(0,u.Z)(i().mark((function t(){var e,n,u;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x((e={},(0,o.Z)(e,T,M),(0,o.Z)(e,"payload",A),e)).unwrap();case 2:n=t.sent,u=n.emailList,(0,Z.t)(u)?(k({status:"success",title:"".concat(u.length," abonn\xe9s invit\xe9s !")}),r.refetch()):k({status:"warning",title:"Aucun abonn\xe9 invit\xe9"}),_(w(w({},L),{},{entity:null}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,b.tZ)(s.u_,{isOpen:!0,onClose:function(){return _(w(w({},L),{},{entity:null}))}},(0,b.tZ)(s.ZA,null,(0,b.tZ)(s.hz,null,(0,b.tZ)(s.xB,null,O(I)?"Notifications":"Invitations"),(0,b.tZ)(s.ol,null),(0,b.tZ)(s.fe,null,(0,b.tZ)(l.bZ,{status:"info",flexDirection:"row"},(0,b.tZ)(l.zM,null),(0,b.tZ)(f.xu,null,"Ci-dessous la liste des abonn\xe9s"," ",n?(0,h.rY)(n.orgType):""," ",(0,b.tZ)("b",null,P)," \xe0"," ",O(I)?"notifier de ":"inviter \xe0 ",D," ",(0,b.tZ)("b",null,B),".")),(0,b.tZ)(f.xu,{overflowX:"auto"},(0,b.tZ)(p.iA,null,(0,b.tZ)(p.p3,null,z.map((function(t){var e="object"===typeof t.user?t.user.email||"":t.email||"",n=t.phone||null;return N(I)&&j.find((function(t){var r=t.email,i=t.phone;return r===e||i===n}))||O(I)&&C.find((function(t){return t.email===e}))?{email:e,phone:n,status:g.Sk.PENDING}:{email:e,phone:n,status:g.Sk.NOK}})).map((function(t){return(0,b.tZ)(p.Tr,{key:t.phone||t.email},(0,b.tZ)(p.Td,null,t.phone||t.email),(0,b.tZ)(p.Td,null,t.status===g.Sk.PENDING?(0,b.tZ)(d.Vp,{colorScheme:"green"},O(I)?"Notifi\xe9":"Invit\xe9"):(0,b.tZ)(v.rU,{onClick:(0,u.Z)(i().mark((function e(){var n,u,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x((n={},(0,o.Z)(n,T,M),(0,o.Z)(n,"payload",w(w({},A),{},{email:t.email})),n)).unwrap();case 2:u=e.sent,a=u.emailList,(0,Z.t)(a)?(k({status:"success",title:"Une ".concat(O(I)?"notification":"invitation"," a \xe9t\xe9 envoy\xe9e \xe0 ").concat(t.email," !")}),r.refetch()):k({status:"warning",title:"Aucun abonn\xe9 ".concat(O(I)?"notifi\xe9":"invit\xe9")});case 5:case"end":return e.stop()}}),e)})))},(0,b.tZ)(d.Vp,{colorScheme:"red"},O(I)?"Notifier":"Inviter"))))}))))),(0,b.tZ)(v.zx,{mt:3,colorScheme:"green",isLoading:E.isLoading,onClick:V},"Envoyer ",z.length-U," ",O(I)?"notifications":"invitations")))))}},54600:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return Z}});var r=n(91229),i=n(67294),o=n(11163),u=n(98238),a=n(12207),c=n(31929),s=n(71096),l=n(1430),f=n(71372),p=n(45754),d=n(43185),v=n(70917),g=function(t){var e=t.isLogin,n=t.setIsLogin,r=((0,o.useRouter)(),(0,u.k)()),g=r.data,h=(r.loading,(0,f.v9)(d.I_)||(null===g||void 0===g?void 0:g.user.email)),m=(0,a.iA)({orgUrl:"aucourant",populate:"orgTopics orgSubscriptions"}),Z=m.data,b=!1;g&&Z&&("object"===typeof Z.createdBy&&Z.createdBy._id===g.user.userId||Z.createdBy===g.user.userId)&&(b=!0);var y=(0,s.xu)(h),w=(0,i.useState)(!!(0,l.C3)({org:Z,subQuery:y})),N=w[0],O=w[1],_=(0,i.useState)((0,l.eM)(Z,y)),L=_[0],k=_[1];return(0,i.useEffect)((function(){Z&&y.data&&(O(!!(0,l.C3)({org:Z,subQuery:y})),k((0,l.eM)(Z,y)))}),[Z,y.data]),m.isLoading?(0,v.tZ)(p.$,null):Z?(0,v.tZ)(c.v,{org:Z,query:m,subQuery:y,isCreator:b,isFollowed:N,isSubscribed:L,setIsLogin:n,isLogin:e}):null},h=n(4293),m=n(59359),Z=function(t){var e=(0,i.useState)(0),n=e[0],o=e[1];return(0,v.tZ)(h.Ar,(0,r.Z)({pageTitle:"Forum",isLogin:n,p:(m.tq,5)},t),(0,v.tZ)(g,{isLogin:n,setIsLogin:o}))}},43697:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/forum",function(){return n(54600)}])}},function(t){t.O(0,[775,929,774,888,179],(function(){return e=43697,t(t.s=e);var e}));var e=t.O();_N_E=e}]);